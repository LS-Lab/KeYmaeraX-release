<!DOCTYPE html>
<!--[if IE 8]> 				 <html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->

<head>
  <meta charset="utf-8" />
  <script src="http://localhost:4000/jss/jquery-1.8.3.min.js" charset="utf-8"></script>
  <style>
	.hl {background: transparent; }
	.hlhover { background:#00aaaa; }
  </style>
</head>
<body>

	<!-- entries -->
	
	<div class="row">
      <div class="large-9 columns">
      	<h1>Formula</h1>
      	<div id="formula">
      	</div>
      	<script>
		$.getJSON("resources/test.json", function(data) {
			console.log(data);
			document.getElementById("formula").innerHTML=handle(data);
		});

		function span(id, cont) { 
			return "<span onmouseover=\"$(event.target).addClass('hlhover');\" onmouseout=\"$(event.target).removeClass('hlhover');\" class='hl' id='" + id + "'>" + cont + "</span>"	
		}

		function handle(json) {
		  var items = [];
		  if(json.name == "not") {
			  var c = json.children;
			  if($.isArray(c)) {
				  var left = handle(c[0]);
				  items.push(span(json.id, "!" + left));
			  }
		  } else if(json.name == "and") {
			  var c = json.children;
			  if($.isArray(c)) {
				  var left = handle(c[0]);
				  var right = handle(c[1]);
				  items.push(span(json.id, left + " &#8743; " + right));
			  }
		  } else if(json.name == "or") {
			  var c = json.children;
			  if($.isArray(c)) {
				  var left = handle(c[0]);
				  var right = handle(c[1]);
				  items.push(span(json.id, left + " &#8744; " + right));
			  }
		  } else if(json.name == "imply") {
			  var c = json.children;
			  if($.isArray(c)) {
				  var left = handle(c[0]);
				  var right = handle(c[1]);
				  items.push(span(json.id, left + " â†’ " + right));
			  }
		  } else if(json.name == "lt") {
			  var c = json.children;
			  if($.isArray(c)) {
				  var left = handle(c[0]);
				  var right = handle(c[1]);
				  items.push(span(json.id, left + " &lt; " + right));
			  }
		  } else if(json.name == "leq") {
			  var c = json.children;
			  if($.isArray(c)) {
				  var left = handle(c[0]);
				  var right = handle(c[1]);
				  items.push(span(json.id, left + " &leq; " + right));
			  }
		  } else if(json.name == "equal") {
			  var c = json.children;
			  if($.isArray(c)) {
				  var left = handle(c[0]);
				  var right = handle(c[1]);
				  items.push(span(json.id, left + " = " + right));
			  }
		  } else if(json.name == "notEqual") {
			  var c = json.children;
			  if($.isArray(c)) {
				  var left = handle(c[0]);
				  var right = handle(c[1]);
				  items.push(span(json.id, left + " &neq; " + right));
			  }
		  } else if(json.name == "geq") {
			  var c = json.children;
			  if($.isArray(c)) {
				  var left = handle(c[0]);
				  var right = handle(c[1]);
				  items.push(span(json.id, left + " &geq; " + right));
			  }
		  } else if(json.name == "gt") {
			  var c = json.children;
			  if($.isArray(c)) {
				  var left = handle(c[0]);
				  var right = handle(c[1]);
				  items.push(span(json.id, left + " &gt; " + right));
			  }
		  } else {
			  var chil = "";
			  if(json.hasOwnProperty("children")) {
				var strs = [];
				var c = json.children;
				for(var i = 0; i < c.length; i++) {
					strs.push(handle(c[i]));	
				}
				chil = "(" + strs.join(", ") + ")";
			  }
			  items.push(span(json.id, json.name + chil));
		  }
		  return items.join("");
		}
      	</script>
      	
      </div>
    </div>
</body>
</html>
